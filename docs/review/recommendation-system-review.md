# 추천 시스템 AI 리뷰 문서

## 1. 알고리즘 설명

### 1.1 목표
- 사용자 참여 이력을 기반으로 퀴즈/투표 콘텐츠를 개인화 추천한다.
- 초기에는 클라이언트에서 가볍게 동작하는 휴리스틱 기반 추천(Phase 1)을 사용한다.

### 1.2 태그 유사도 (Jaccard)
- 태그 집합 A, B에 대해 `|A ∩ B| / |A ∪ B|`로 유사도를 계산한다.
- 태그가 둘 다 비어 있으면 0으로 처리한다.

### 1.3 콘텐츠 유사도 점수
- 태그 유사도와 카테고리 일치를 조합한다.
```
score = tagSimilarity * 0.7 + categoryMatch * 0.3
```
- `categoryMatch`는 같은 카테고리면 1, 아니면 0이다.

### 1.4 참여 이력 기반 추천
- 사용자가 참여하지 않은 콘텐츠에 대해, 참여한 콘텐츠들과의 유사도를 계산한다.
- 최대 유사도와 평균 유사도를 결합해 최종 점수를 만든다.
```
combinedScore = maxSimilarity * 0.7 + avgSimilarity * 0.3
```
- `combinedScore > 0.1`만 추천 대상으로 유지하고, 점수 내림차순으로 정렬한다.

### 1.5 참여 이력 부족 시(콜드 스타트)
- 참여 이력이 없으면 유사도 기반 추천을 건너뛰고, 선호 점수 기반 정렬을 사용한다.
- 선호 점수는 카테고리 참여(0.4), 태그 매칭(0.3), 난이도 적합(0.2), 신선도 보너스(0.1)로 구성된다.
- 연령 제한 필터를 적용한 뒤 추천 목록을 구성한다.

---

## 2. 구현 코드 참조

- `src/services/ContentRecommendationService.ts`
  - Jaccard 유사도 계산, 유사도 기반 추천 로직.
- `src/services/UserPreferenceService.ts`
  - 참여 이력 기록, 선호 점수 계산, 연령 필터링, 추천 통합.
- `scripts/test-recommendation.mjs`
  - 추천 로직 검증용 테스트 스크립트.

---

## 3. 테스트 결과

실행 명령:
```
node scripts/test-recommendation.mjs
```

결과 요약:
- Jaccard 유사도 테스트: 5개 통과
- 콘텐츠 유사도 테스트: 4개 통과
- 참여 이력 기반 추천 테스트: 5개 통과
- 엣지 케이스 테스트: 3개 통과
- 총 17개 통과, 0개 실패

---

## 4. 비용 분석

### Phase 1 (현재)
- 계산 위치: 클라이언트(브라우저)
- 저장소: `localStorage` (참여 이력/선호도)
- 서버 비용: 없음
- 운영 비용: **$0**

### Phase 2 (추가 확장 시)
- 계산 위치: 서버(Turso DB 기반 협업 필터링 예정)
- 저장소: DB 집계 및 모델 입력 데이터
- 비용 요인: 쿼리 비용 + 저장 용량 + 배치/실시간 계산 비용
- 고려 사항: 데이터 증가에 따른 추천 계산 O(n*m) 비용 완화 필요

---

## 5. 리뷰 요청 사항

### 5.1 알고리즘 적정성
- [ ] 가중치 설정(태그 0.7, 카테고리 0.3)이 적절한가?
- [ ] 참여 이력 결합 방식(최대 0.7 + 평균 0.3)이 합리적인가?
- [ ] 최소 유사도 임계값(0.1)이 너무 높거나 낮지 않은가?

### 5.2 제품/경험 관점
- [ ] 콜드 스타트에서 추천이 충분히 다양하게 보이는가?
- [ ] 연령 제한 필터가 사용자 기대와 충돌하지 않는가?

### 5.3 확장성/운영
- [ ] 콘텐츠 수 증가 시 계산 비용 병목이 생기지 않는가?
- [ ] Phase 2 전환 시 필요한 로그/지표 정의가 충분한가?
